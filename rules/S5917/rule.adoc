When creating a `+DateTimeFormatter+` using the "ww" pattern or the `+WeekFields.weekOfWeekBasedYear()+` temporal field, the resulting week number may be 1 at the end of a year (when the week in question is both the last week of the current year and the first week of the next one). When using this week number in combination with the current year, it would falsely refer to the first week of the current year instead of the first week of the next year.

Instead the week number should be used with the week-based year, which is accessible through the "YY" or "YYYY" patterns or the `+WeekFields.weekBasedYear()+` temporal field.

Alternatively the temporal field `+ChronoField.ALIGNED_WEEK_OF_YEAR+` can be used together with the regular year (but not the week based year).


== Noncompliant Code Example

----
DateTimeFormatter.ofPattern("yyyy-ww") // Noncompliant: using week of week-based year with regular year

new DateTimeFormatterBuilder()
      .appendValue(ChronoField.YEAR, 4) // Noncompliant: using week of week-based year with regular year
      .appendLiteral('-')
      .appendValue(WeekFields.ISO.weekOfWeekBasedYear(), 2)
      .toFormatter()

DateTimeFormatterBuilder()
      .appendValue(WeekFields.ISO.weekBasedYear(), 4) // Noncompliant: using aligned week of year with week-based year
      .appendLiteral('-')
      .appendValue(ChronoField.ALIGNED_WEEK_OF_YEAR, 2)
      .toFormatter()
----

Here the first two formatters would wrongly format the 31st of December 2019 as "2019-01" and the third would wrongly format it as "2020-32".


== Compliant Solution

----
DateTimeFormatter.ofPattern("YYYY-ww")

new DateTimeFormatterBuilder()
      .appendValue(WeekFields.ISO.weekBasedYear(), 4)
      .appendLiteral('-')
      .appendValue(WeekFields.ISO.weekOfWeekBasedYear(), 2)
      .toFormatter()

DateTimeFormatterBuilder()
      .appendValue(ChronoField.YEAR, 4)
      .appendLiteral('-')
      .appendValue(ChronoField.ALIGNED_WEEK_OF_YEAR, 2)
      .toFormatter()
----

Here the first two formatters would format the 31st of December 2019 as "2020-01" and the third would format it as "2019-32", both of which are correct depending on how you count the weeks.


== Exceptions

No issue is raised when both types of year are used in the same format to allow formats such as "2019-12-31 (week 2020-01)".


include::../description.adoc[]

include::../recommended.adoc[]

== Noncompliant Code Example

Below, the hashed password is not salted or use a predictable salt:

----
PBEKeySpec spec = new PBEKeySpec(chars); // Noncompliant, no salt as an argument, will throw an error at the run-time
----

----
byte[] salt = "notrandom".getBytes();
PBEKeySpec spec = new PBEKeySpec(chars, salt, 10000, 256); // Noncompliant, predictable salt
----

== Compliant Solution

Use ``++java.security.SecureRandom++`` to generate an unpredictable salt:

----
SecureRandom random = new SecureRandom();
byte[] salt = new byte[16];
random.nextBytes(salt);

PBEKeySpec spec = new PBEKeySpec(chars, salt, 10000, 256); // Compliant
----

include::../see.adoc[]

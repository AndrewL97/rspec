include::../description.adoc[]

== Noncompliant Code Example

In a ``++AndroidManifest.xml++`` file, an exported component is vulnerable when read and write permissions are not defined:

----
<provider
  android:authorities="com.example.myapp.MyProvider1"
  android:name="com.example.myapp.MyProvider1"
  android:exported="true"
  android:readPermission="com.example.myapp.READ_PERMISSION" />  <!-- Noncompliant: write permission is not defined --> 

<provider
  android:authorities="com.example.myapp.MyProvider2"
  android:name="com.example.myapp.MyProvider2"
  android:exported="true"
  android:writePermission="com.example.myapp.WRITE_PERMISSION" />  <!-- Noncompliant: read permissions is not defined --> 
----

== Compliant Solution

In a ``++AndroidManifest.xml++`` file, if it is not needed to export a component to other apps then set the ``++exported++`` property to ``++false++``:

----
<provider
  android:authorities="com.example.myapp.MyProvider1"
  android:name="com.example.myapp.MyProvider1"
  android:exported="false" />  <!-- Compliant --> 
----

Otherwise implement permissions (``++protectionLevel++`` https://developer.android.com/guide/topics/manifest/permission-element#plevel[value] must be defined depending on the  sensitivity of the component):

----
<permission android:name="com.example.myapp.A_PERMISSION"
  android:protectionLevel="dangerous" />

<provider
  android:authorities="com.example.myapp.MyProvider2"
  android:name="com.example.myapp.MyProvider2"
  android:exported="true"
  android:permission="com.example.myapp.A_PERMISSION"  />  <!-- Compliant --> 
----

include::../see.adoc[]
